
Epoch [1/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 61.95it/s, loss=0.589]
Epoch 1/100, Loss: 0.6468098530402551
Epoch [2/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 214.21it/s, loss=0.364]
Epoch 2/100, Loss: 0.4260650735635024
Epoch [3/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 222.50it/s, loss=0.265]
Epoch 3/100, Loss: 0.3074565392274123
Epoch [4/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 226.70it/s, loss=0.209]
Epoch 4/100, Loss: 0.24092870721450219
Epoch [5/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 226.11it/s, loss=0.217]
Epoch 5/100, Loss: 0.20435282931878015
Epoch [6/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 206.20it/s, loss=0.154]
Epoch 6/100, Loss: 0.17949565328084505
Epoch [7/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 212.08it/s, loss=0.164]
Epoch 7/100, Loss: 0.16492324494398558
Epoch [8/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 184.02it/s, loss=0.171]
Epoch 8/100, Loss: 0.15471390004341418
Epoch [9/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 248.22it/s, loss=0.116]
Epoch 9/100, Loss: 0.145393329171034
Epoch [10/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 210.28it/s, loss=0.134]
Epoch 10/100, Loss: 0.14057378872082785
Epoch [11/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 239.02it/s, loss=0.129]
Epoch 11/100, Loss: 0.13582585694698188
Epoch [12/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 251.01it/s, loss=0.127]
Epoch 12/100, Loss: 0.13229500674284422
Epoch [13/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 237.41it/s, loss=0.117]
Epoch 13/100, Loss: 0.12883314490318298
Epoch [14/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 233.36it/s, loss=0.185]
Epoch 14/100, Loss: 0.12831334081979898
Epoch [15/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 220.47it/s, loss=0.163]
Epoch 15/100, Loss: 0.12499978164067635
Epoch [16/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 199.93it/s, loss=0.136]
Epoch 16/100, Loss: 0.12220276261751468
Epoch [17/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 230.67it/s, loss=0.118]
Epoch 17/100, Loss: 0.12008278988874875
Epoch [18/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 223.32it/s, loss=0.102]
Epoch 18/100, Loss: 0.1176845574608216
Epoch [19/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 178.07it/s, loss=0.122]
Epoch 19/100, Loss: 0.11645224002691415
Epoch [20/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 197.80it/s, loss=0.0974]
Epoch 20/100, Loss: 0.1141689855318803
Epoch [21/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 182.03it/s, loss=0.124]
Epoch 21/100, Loss: 0.11358592487298526
Epoch [22/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 205.60it/s, loss=0.17]
Epoch 22/100, Loss: 0.11356993707326743
Epoch [23/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 169.46it/s, loss=0.0926]
Epoch 23/100, Loss: 0.1097164939229305
Epoch [24/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 219.15it/s, loss=0.0817]
Epoch 24/100, Loss: 0.10782983211370614
Epoch [25/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 217.11it/s, loss=0.0786]
Epoch 25/100, Loss: 0.10628195164295343
Epoch [26/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 185.10it/s, loss=0.0846]
Epoch 26/100, Loss: 0.1056386513205675
Epoch [27/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 186.45it/s, loss=0.136]
Epoch 27/100, Loss: 0.10608172645935646
Epoch [28/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 158.12it/s, loss=0.118]
Epoch 28/100, Loss: 0.10441363430940188
Epoch [29/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 186.08it/s, loss=0.0937]
Epoch 29/100, Loss: 0.10252280590625909
Epoch [30/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 202.25it/s, loss=0.106]
Epoch 30/100, Loss: 0.10193469432684091
Epoch [31/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 201.30it/s, loss=0.0773]
Epoch 31/100, Loss: 0.09998403317653216
Epoch [32/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 193.91it/s, loss=0.0846]
Epoch 32/100, Loss: 0.09889763249800755
Epoch [33/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 236.72it/s, loss=0.0697]
Epoch 33/100, Loss: 0.09774464426132348
Epoch [34/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 197.51it/s, loss=0.0766]
Epoch 34/100, Loss: 0.0966087866287965
Epoch [35/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 209.77it/s, loss=0.0844]
Epoch 35/100, Loss: 0.09613828189097919
Epoch [36/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 206.91it/s, loss=0.131]
Epoch 36/100, Loss: 0.09706173378687638
Epoch [37/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 216.94it/s, loss=0.083]
Epoch 37/100, Loss: 0.09472638884415993
Epoch [38/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 217.29it/s, loss=0.0636]
Epoch 38/100, Loss: 0.09269141348508689
Epoch [39/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 215.67it/s, loss=0.105]
Epoch 39/100, Loss: 0.09351710115487759
Epoch [40/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 217.49it/s, loss=0.0906]
Epoch 40/100, Loss: 0.09173607711608593
Epoch [41/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 223.03it/s, loss=0.0874]
Epoch 41/100, Loss: 0.09085672119489083
Epoch [42/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 206.99it/s, loss=0.0632]
Epoch 42/100, Loss: 0.08917879026669723
Epoch [43/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 199.26it/s, loss=0.0775]
Epoch 43/100, Loss: 0.08921968879608008
Epoch [44/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 193.13it/s, loss=0.143]
Epoch 44/100, Loss: 0.09067433757277635
Epoch [45/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 214.86it/s, loss=0.0785]
Epoch 45/100, Loss: 0.08721396155082263
Epoch [46/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 198.30it/s, loss=0.0766]
Epoch 46/100, Loss: 0.08649074114285983
Epoch [47/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 182.11it/s, loss=0.0788]
Epoch 47/100, Loss: 0.08574453798624185
Epoch [48/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 186.83it/s, loss=0.0859]
Epoch 48/100, Loss: 0.08536288829950187
Epoch [49/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 202.26it/s, loss=0.0686]
Epoch 49/100, Loss: 0.08379622319569954
Epoch [50/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 230.34it/s, loss=0.178]
Epoch 50/100, Loss: 0.08703928096936299
Epoch [51/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 227.15it/s, loss=0.0596]
Epoch 51/100, Loss: 0.08244858596187371
Epoch [52/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 235.71it/s, loss=0.0792]
Epoch 52/100, Loss: 0.08207726994386086
Epoch [53/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 212.53it/s, loss=0.0577]
Epoch 53/100, Loss: 0.08065013530162665
Epoch [54/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 202.41it/s, loss=0.0759]
Epoch 54/100, Loss: 0.08047654193181258
Epoch [55/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 200.35it/s, loss=0.0743]
Epoch 55/100, Loss: 0.07993036136031151
Epoch [56/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 195.16it/s, loss=0.107]
Epoch 56/100, Loss: 0.08035121170374063
Epoch [57/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 181.28it/s, loss=0.11]
Epoch 57/100, Loss: 0.0794893537576382
Epoch [58/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 219.12it/s, loss=0.125]
Epoch 58/100, Loss: 0.07931415192209758
Epoch [59/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 210.51it/s, loss=0.0915]
Epoch 59/100, Loss: 0.07763326712525807
Epoch [60/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 205.18it/s, loss=0.0638]
Epoch 60/100, Loss: 0.07605459884955333
Epoch [61/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 207.35it/s, loss=0.0677]
Epoch 61/100, Loss: 0.07554297636334713
Epoch [62/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 187.22it/s, loss=0.0538]
Epoch 62/100, Loss: 0.0746979765020884
Epoch [63/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 213.15it/s, loss=0.089]
Epoch 63/100, Loss: 0.07498890935228421
Epoch [64/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 193.59it/s, loss=0.0616]
Epoch 64/100, Loss: 0.07341277398742162
Epoch [65/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 195.45it/s, loss=0.076]
Epoch 65/100, Loss: 0.07324438971968797
Epoch [66/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 191.62it/s, loss=0.0557]
Epoch 66/100, Loss: 0.07176372036337852
Epoch [67/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 194.73it/s, loss=0.0819]
Epoch 67/100, Loss: 0.07242705730291513
Epoch [68/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 209.21it/s, loss=0.0646]
Traceback (most recent call last):
  File "/mnt/hdd/pengy/insole_anno/train.py", line 107, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 44, in train
    test(model, test_loader, criterion, device)
  File "/mnt/hdd/pengy/insole_anno/train.py", line 62, in test
    plot_insole_heatmap_gif(y, outputs, f'./results/test_{i}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 655, in _write_multiple_frames
    mask = ImageMath.lambda_eval(
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 267, in lambda_eval
    out = expression(args)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 657, in <lambda>
    args["max"](
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 127, in __mul__
    return self.apply("mul", self, other)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 96, in apply
    _imagingmath.binop(op, out.im.id, im_1.im.id, im_2.im.id)
KeyboardInterrupt
Epoch 68/100, Loss: 0.07121664572220582