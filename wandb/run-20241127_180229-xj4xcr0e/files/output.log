Epoch [1/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 119.23it/s, loss=0.253]
Epoch [2/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 220.17it/s, loss=0.152]
Epoch [3/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 215.84it/s, loss=0.0774]
Epoch 1/100, Loss: 0.4234207169367717
Epoch 2/100, Loss: 0.2154486391406793
Epoch 3/100, Loss: 0.14683277847675177
Epoch [4/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 226.08it/s, loss=0.114]
Epoch [5/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.29it/s, loss=0.0778]
Epoch [6/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 286.49it/s, loss=0.0943]
Epoch 4/100, Loss: 0.1241558724297927
Epoch 5/100, Loss: 0.11166284749141106
Epoch 6/100, Loss: 0.10712185358771911
Epoch 7/100, Loss: 0.10567396334730662
Epoch [7/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 270.22it/s, loss=0.16]
Epoch [8/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 284.00it/s, loss=0.129]
Epoch [9/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 275.93it/s, loss=0.227]
Epoch 8/100, Loss: 0.10144357411907269
Epoch 9/100, Loss: 0.10291207524446341
Epoch 10/100, Loss: 0.09890438301058915
Epoch [10/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 300.61it/s, loss=0.164]
Epoch [11/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.43it/s, loss=0.221]
Epoch [12/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 313.55it/s, loss=0.195]
Epoch [13/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 338.79it/s, loss=0.0717]
Epoch 11/100, Loss: 0.09905077517032623
Epoch 12/100, Loss: 0.09678304224060132
Epoch 13/100, Loss: 0.09173340694262432
Epoch 14/100, Loss: 0.09058206900954247
Epoch [14/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 324.11it/s, loss=0.0777]
Epoch [15/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.42it/s, loss=0.0635]
Epoch [16/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 276.42it/s, loss=0.105]
Epoch 15/100, Loss: 0.08819792620264567
Epoch 16/100, Loss: 0.08835434340513669
Epoch 17/100, Loss: 0.08662858146887559
Epoch [17/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 290.31it/s, loss=0.0929]
Epoch [18/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 294.81it/s, loss=0.0765]
Epoch [19/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 295.87it/s, loss=0.102]
Epoch [20/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 292.61it/s, loss=0.0938]
Epoch 18/100, Loss: 0.0850564711369001
Epoch 19/100, Loss: 0.0844743622896763
Epoch 20/100, Loss: 0.08283184053233036
Epoch 21/100, Loss: 0.08003468424654923
Epoch [21/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 283.37it/s, loss=0.0459]
Epoch [22/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 276.79it/s, loss=0.0863]
Epoch [23/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 265.92it/s, loss=0.0432]
Epoch 22/100, Loss: 0.0802775243153939
Epoch 23/100, Loss: 0.07777749947630443
Epoch [24/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 302.03it/s, loss=0.106]
Traceback (most recent call last):
  File "/mnt/hdd/pengy/insole_anno/train.py", line 74, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 34, in train
    plot_insole_heatmap_gif(y, outputs, f'./results/output_{epoch}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 624, in _write_multiple_frames
    delta, bbox = _getbbox(previous_im, im_frame)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 588, in _getbbox
    return delta, delta.getbbox(alpha_only=False)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 1348, in getbbox
    return self.im.getbbox(alpha_only)
KeyboardInterrupt