
Epoch [1/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 126.80it/s, loss=0.461]
Epoch 1/100, Loss: 0.5406296172967324
Epoch [2/100]:   0%|                                                                                                                                                                                                                                                                      | 0/26 [00:00<?, ?it/s, loss=0.255]

Epoch [2/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 255.78it/s, loss=0.248]
Epoch [3/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 225.16it/s, loss=0.298]
Epoch 3/100, Loss: 0.2059477877158385
Epoch [4/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 250.36it/s, loss=0.146]
Epoch 4/100, Loss: 0.1614944373185818
Epoch [5/100]:   0%|                                                                                                                                                                                                                                                                      | 0/26 [00:00<?, ?it/s, loss=0.164]

Epoch [5/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 243.19it/s, loss=0.11]
Epoch [6/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 207.90it/s, loss=0.101]
Epoch 6/100, Loss: 0.1238063032237383
Epoch [7/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 219.57it/s, loss=0.077]
Epoch 7/100, Loss: 0.1133358094554681
Epoch [8/100]:   0%|                                                                                                                                                                                                                                                                      | 0/26 [00:00<?, ?it/s, loss=0.107]

Epoch [8/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 223.81it/s, loss=0.0982]
Epoch [9/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 221.78it/s, loss=0.0865]
Epoch 9/100, Loss: 0.10244212500177897
Epoch [10/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 221.96it/s, loss=0.0659]
Epoch 10/100, Loss: 0.09869496323741399
Epoch [11/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 211.45it/s, loss=0.106]
Epoch 11/100, Loss: 0.09709117275017959
Epoch [12/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 225.45it/s, loss=0.147]
Epoch 12/100, Loss: 0.09618341750823535
Epoch [13/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 235.15it/s, loss=0.113]
Epoch 13/100, Loss: 0.09342575474427296
Epoch [14/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.22it/s, loss=0.118]
Epoch 14/100, Loss: 0.091300735106835
Epoch [15/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 294.43it/s, loss=0.0959]
Epoch 15/100, Loss: 0.0893933828920126
Epoch [16/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 297.59it/s, loss=0.0549]
Epoch 16/100, Loss: 0.0867955585798392
Epoch [17/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.08it/s, loss=0.0593]
Epoch 17/100, Loss: 0.08562490028830674
Epoch [18/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 278.01it/s, loss=0.0466]
Epoch 18/100, Loss: 0.08330006553576542
Epoch [19/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 288.31it/s, loss=0.0797]
Epoch 19/100, Loss: 0.08303063162244283
Epoch [20/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 307.16it/s, loss=0.0867]
Epoch 20/100, Loss: 0.08220127124625903
Epoch [21/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 270.76it/s, loss=0.0604]
Epoch 21/100, Loss: 0.07975002421209446
Epoch [22/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 284.01it/s, loss=0.0942]
Epoch 22/100, Loss: 0.07961320447234008
Epoch [23/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 316.59it/s, loss=0.057]
Epoch 23/100, Loss: 0.07721059253582588
Epoch [24/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.71it/s, loss=0.0451]
Epoch 24/100, Loss: 0.07558861532463478
Epoch [25/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 286.08it/s, loss=0.101]
Epoch 25/100, Loss: 0.07659146332970032
Epoch [26/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 248.88it/s, loss=0.0502]
Epoch 26/100, Loss: 0.07365148973006469
Epoch [27/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 324.90it/s, loss=0.112]
Epoch 27/100, Loss: 0.07448276547858348
Epoch [28/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 278.78it/s, loss=0.0476]
Epoch 28/100, Loss: 0.07116587947194393
Epoch [29/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 315.82it/s, loss=0.05]
Epoch 29/100, Loss: 0.06995438426159896
Epoch [30/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 325.41it/s, loss=0.0933]
Epoch 30/100, Loss: 0.07055653531390887
Epoch [31/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 329.53it/s, loss=0.0731]
Epoch 31/100, Loss: 0.0684276598577316
Epoch [32/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 284.72it/s, loss=0.0299]
Epoch 32/100, Loss: 0.06636414032142895
Epoch [33/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.065]

Epoch [33/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 263.19it/s, loss=0.0536]
Epoch [34/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 292.06it/s, loss=0.0514]
Epoch 34/100, Loss: 0.06547059204715949
Epoch [35/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 283.46it/s, loss=0.0303]
Epoch 35/100, Loss: 0.06363315421801347
Epoch 36/100, Loss: 0.06292541826573703
Epoch [36/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 269.82it/s, loss=0.0526]
Epoch [37/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 231.03it/s, loss=0.0443]
Epoch 37/100, Loss: 0.06167820067359851
Epoch [38/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 232.06it/s, loss=0.0547]
Epoch 38/100, Loss: 0.06140678318647238
Epoch [39/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 226.57it/s, loss=0.041]
Epoch 39/100, Loss: 0.05982496202565157
Epoch [40/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 265.23it/s, loss=0.0579]
Epoch 40/100, Loss: 0.05896776613707726
Epoch [41/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 224.94it/s, loss=0.0459]
Epoch 41/100, Loss: 0.05773772313617743
Epoch [42/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 246.68it/s, loss=0.04]
Epoch 42/100, Loss: 0.05723810296219129
Epoch [43/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 240.29it/s, loss=0.044]
Epoch 43/100, Loss: 0.056097814813256264
Epoch [44/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 243.15it/s, loss=0.0405]
Epoch 44/100, Loss: 0.055009063046712145

Epoch [45/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 226.34it/s, loss=0.0408]
Epoch 45/100, Loss: 0.0538607112203653
Epoch [46/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 238.51it/s, loss=0.0521]
Epoch 46/100, Loss: 0.05404800319900879
Epoch [47/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 279.08it/s, loss=0.0445]
Epoch 47/100, Loss: 0.052779046388772816
Epoch [48/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 260.62it/s, loss=0.034]
Epoch 48/100, Loss: 0.05171389046769876
Epoch [49/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 251.37it/s, loss=0.0888]
Epoch 49/100, Loss: 0.05287880493471256
Epoch [50/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 244.65it/s, loss=0.0273]
Epoch 50/100, Loss: 0.05074982731961287
Epoch [51/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 269.88it/s, loss=0.0354]
Epoch 51/100, Loss: 0.04982041309659298
Epoch [52/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 222.18it/s, loss=0.0316]
Epoch 52/100, Loss: 0.048947170233497254
Epoch [53/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 225.55it/s, loss=0.0639]
Epoch 53/100, Loss: 0.04937067785515235
Epoch [54/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 221.66it/s, loss=0.183]
Epoch 54/100, Loss: 0.052094425862798326
Epoch [55/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 231.39it/s, loss=0.0482]
Epoch 55/100, Loss: 0.047370018294224374
Epoch [56/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 232.89it/s, loss=0.0528]
Epoch 56/100, Loss: 0.047139460077652566
Epoch [57/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 230.92it/s, loss=0.045]
Epoch 57/100, Loss: 0.04669765970454766
Epoch [58/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 230.87it/s, loss=0.0412]
Epoch 58/100, Loss: 0.04573066339183312
Epoch [59/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 223.30it/s, loss=0.0857]
Epoch 59/100, Loss: 0.04656162227575596
Epoch [60/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 230.61it/s, loss=0.0423]
Epoch 60/100, Loss: 0.04536615383739655
Epoch [61/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 280.47it/s, loss=0.0415]
Epoch 61/100, Loss: 0.044246274404800855
Epoch [62/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 282.70it/s, loss=0.0387]
Epoch 62/100, Loss: 0.04388196838016693
Epoch [63/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 314.39it/s, loss=0.0298]
Epoch 63/100, Loss: 0.04325303757706514
Epoch [64/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 268.83it/s, loss=0.0332]
Epoch 64/100, Loss: 0.04259489970998122
Epoch [65/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 297.97it/s, loss=0.0298]
Epoch 65/100, Loss: 0.042102100112690374
Epoch [66/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 294.21it/s, loss=0.0481]
Epoch 66/100, Loss: 0.04221406729462055
Epoch [67/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 300.59it/s, loss=0.0189]
Epoch 67/100, Loss: 0.04106399345283325
Epoch [68/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 294.24it/s, loss=0.0319]
Epoch 68/100, Loss: 0.04126828421766941
Traceback (most recent call last):
  File "/mnt/hdd/pengy/insole_anno/train.py", line 76, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 38, in train
    test(model, test_loader, criterion, device)
  File "/mnt/hdd/pengy/insole_anno/train.py", line 50, in test
    plot_insole_heatmap_gif(y, outputs, f'./results/test_{i}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 655, in _write_multiple_frames
    mask = ImageMath.lambda_eval(
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 267, in lambda_eval
    out = expression(args)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 658, in <lambda>
    args["max"](
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 221, in imagemath_max
    return self.apply("max", self, other)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 96, in apply
    _imagingmath.binop(op, out.im.id, im_1.im.id, im_2.im.id)
KeyboardInterrupt