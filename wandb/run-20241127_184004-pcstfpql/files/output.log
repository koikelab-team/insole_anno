
Epoch [1/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 136.05it/s, loss=0.21]
Epoch 1/100, Loss: 0.3002360812746562
Epoch [2/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 264.78it/s, loss=0.151]
Epoch 2/100, Loss: 0.1486221941617819
Epoch [3/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 248.30it/s, loss=0.159]
Epoch 3/100, Loss: 0.11863739759876178
Epoch [4/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 289.89it/s, loss=0.0776]
Epoch 4/100, Loss: 0.1043174510391859
Epoch 5/100, Loss: 0.091694007985867
Epoch [5/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 313.71it/s, loss=0.0901]
Epoch 6/100, Loss: 0.0840812003096709
Epoch [6/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 303.66it/s, loss=0.0874]
Epoch [7/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.0573]

Epoch [7/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 303.16it/s, loss=0.0689]
Epoch [8/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.0604]

Epoch [8/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.85it/s, loss=0.0765]
Epoch [9/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.0798]

Epoch [9/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 303.98it/s, loss=0.123]
Epoch [10/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 304.90it/s, loss=0.107]
Epoch 10/100, Loss: 0.06874270378970183
Epoch [11/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 284.27it/s, loss=0.0361]
Epoch 11/100, Loss: 0.06350099538954404
Epoch [12/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.34it/s, loss=0.0457]
Epoch 12/100, Loss: 0.060406398887817674
Epoch [13/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 312.36it/s, loss=0.0571]
Epoch 13/100, Loss: 0.057056196607076205
Epoch [14/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 304.74it/s, loss=0.0361]
Epoch 14/100, Loss: 0.0538445244041773
Epoch [15/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 308.55it/s, loss=0.0363]
Epoch 15/100, Loss: 0.049981713080062315
Epoch [16/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 312.92it/s, loss=0.0412]
Epoch 16/100, Loss: 0.049562469124794006
Epoch [17/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 312.01it/s, loss=0.137]
Epoch 17/100, Loss: 0.05096218462746877
Epoch [18/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 295.31it/s, loss=0.021]
Epoch 18/100, Loss: 0.04508674481453804
Epoch [19/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.77it/s, loss=0.0822]
Epoch 19/100, Loss: 0.045386030768545776
Epoch [20/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 295.04it/s, loss=0.0432]
Epoch 20/100, Loss: 0.042372155361450635
Epoch [21/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 287.26it/s, loss=0.0197]
Epoch 21/100, Loss: 0.040576459195178285
Epoch [22/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.13it/s, loss=0.0324]
Epoch 22/100, Loss: 0.040138079068408564
Epoch [23/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 293.45it/s, loss=0.0388]
Epoch 23/100, Loss: 0.038750335860710874
Epoch [24/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 309.39it/s, loss=0.0352]
Epoch 24/100, Loss: 0.03783032090331499
Epoch [25/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 287.70it/s, loss=0.0832]
Epoch 25/100, Loss: 0.03760119198033443
Epoch [26/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 317.84it/s, loss=0.0451]
Epoch 26/100, Loss: 0.03778420632275251

Epoch [27/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 308.68it/s, loss=0.0403]
Epoch 27/100, Loss: 0.034864493215886444

Epoch [28/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 292.14it/s, loss=0.0224]
Epoch 28/100, Loss: 0.03334227240142914

Epoch [29/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 305.21it/s, loss=0.0355]
Epoch 29/100, Loss: 0.033810702009269826
Epoch [30/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 301.11it/s, loss=0.0337]
Traceback (most recent call last):
Epoch 30/100, Loss: 0.03191703450507843
  File "/mnt/hdd/pengy/insole_anno/train.py", line 82, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 38, in train
    test(model, test_loader, criterion, device)
  File "/mnt/hdd/pengy/insole_anno/train.py", line 52, in test
    plot_insole_heatmap_gif(y, outputs, f'./results/test_{i}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 655, in _write_multiple_frames
    mask = ImageMath.lambda_eval(
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 267, in lambda_eval
    out = expression(args)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 659, in <lambda>
    args["max"](args["r"], args["g"]), args["b"]
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 221, in imagemath_max
    return self.apply("max", self, other)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 96, in apply
    _imagingmath.binop(op, out.im.id, im_1.im.id, im_2.im.id)
KeyboardInterrupt