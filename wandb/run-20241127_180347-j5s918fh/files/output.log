Epoch [1/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 129.20it/s, loss=0.26]
Epoch [2/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 242.29it/s, loss=0.17]
Epoch [3/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 240.95it/s, loss=0.157]
Epoch 1/100, Loss: 0.34924417447585326
Epoch 2/100, Loss: 0.19749089158498323
Epoch 3/100, Loss: 0.15235084295272827
Epoch [4/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 246.16it/s, loss=0.103]
Epoch [5/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 253.20it/s, loss=0.193]
Epoch [6/100]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 276.69it/s, loss=0.11]
Epoch 4/100, Loss: 0.1295120558486535
Epoch 5/100, Loss: 0.1210452621945968
Epoch 6/100, Loss: 0.11133304954721378
Epoch [7/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 287.87it/s, loss=0.119]
Epoch [8/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 251.24it/s, loss=0.0926]
Epoch [9/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 253.46it/s, loss=0.107]
Epoch [10/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.107]
Epoch 7/100, Loss: 0.1073063609118645
Epoch 8/100, Loss: 0.10279828367324975
Epoch 9/100, Loss: 0.10046901897742198
Epoch [10/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 308.35it/s, loss=0.154]
Epoch [11/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.87it/s, loss=0.164]
Epoch [12/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 258.62it/s, loss=0.0835]
Epoch [13/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 282.51it/s, loss=0.167]
Epoch 11/100, Loss: 0.09808386776309747
Epoch 12/100, Loss: 0.09373555404062454
Epoch 13/100, Loss: 0.09434836243207638
Epoch [14/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 300.56it/s, loss=0.0867]
Epoch [15/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 270.00it/s, loss=0.0789]
Epoch [16/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 272.05it/s, loss=0.111]
Epoch [17/100]:   0%|                                                                                                                                                                                                                                                                    | 0/26 [00:00<?, ?it/s, loss=0.0663]
Epoch 14/100, Loss: 0.0899573819568524
Epoch 15/100, Loss: 0.0880221793284783
Epoch [17/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 369.12it/s, loss=0.0663]
Epoch [18/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 332.45it/s, loss=0.0663]
Epoch [19/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 323.28it/s, loss=0.0594]
Epoch [20/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 331.55it/s, loss=0.219]
Epoch 17/100, Loss: 0.08505982332504712
Epoch 18/100, Loss: 0.0833400096744299
Epoch 19/100, Loss: 0.08162319846451283
Epoch 20/100, Loss: 0.08488621892264256
Epoch [21/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 310.42it/s, loss=0.0962]
Epoch [22/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 297.82it/s, loss=0.0556]
Epoch [23/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 280.88it/s, loss=0.16]
Epoch [24/100]:   0%|                                                                                                                                                                                                                                                                    | 0/26 [00:00<?, ?it/s, loss=0.0728]
Epoch 21/100, Loss: 0.08032732614530967
Epoch 22/100, Loss: 0.07757825003220485
Epoch [24/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 289.55it/s, loss=0.0502]
Traceback (most recent call last):
  File "/mnt/hdd/pengy/insole_anno/train.py", line 74, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 34, in train
    plot_insole_heatmap_gif(y, outputs, f'./results/output_{epoch}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 602, in _write_multiple_frames
    im_frame = _normalize_mode(im_frame.copy())
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 492, in _normalize_mode
    im = im.convert("P", palette=Image.Palette.ADAPTIVE)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 980, in convert
    return self.quantize(colors)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 1196, in quantize
    im = self._new(self.im.quantize(colors, method, kmeans))
KeyboardInterrupt