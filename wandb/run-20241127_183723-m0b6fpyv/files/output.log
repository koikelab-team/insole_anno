
Epoch [1/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 100.72it/s, loss=0.236]
Epoch 1/100, Loss: 0.29567195589725787
Epoch [2/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 307.16it/s, loss=0.186]
Epoch 2/100, Loss: 0.14693547470065263
Epoch 3/100, Loss: 0.11298803555277678
Epoch [3/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 309.97it/s, loss=0.0839]
Epoch [4/100]:   0%|                                                                                                                                                                                                                                                                     | 0/26 [00:00<?, ?it/s, loss=0.0923]

Epoch [4/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 287.44it/s, loss=0.116]
Epoch [5/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 286.84it/s, loss=0.106]
Epoch 5/100, Loss: 0.08978914698729148
Epoch [6/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 279.30it/s, loss=0.0703]
Epoch 6/100, Loss: 0.08195617264853074
Epoch [7/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 269.15it/s, loss=0.0774]
Epoch 7/100, Loss: 0.07777749646741611
Epoch [8/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 279.13it/s, loss=0.0561]
Epoch 8/100, Loss: 0.07319052130557023
Epoch [9/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 273.03it/s, loss=0.0689]
Epoch 9/100, Loss: 0.06926456580941494
Epoch [10/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 259.38it/s, loss=0.0287]
Epoch 10/100, Loss: 0.0655099033163144
Epoch [11/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 286.29it/s, loss=0.0484]
Epoch 11/100, Loss: 0.062068043706508785
Epoch 12/100, Loss: 0.06124091305984901
Epoch [12/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 302.08it/s, loss=0.112]
Epoch 13/100, Loss: 0.05796739659630335
Epoch [13/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 291.16it/s, loss=0.116]
Epoch [14/100]:   0%|                                                                                                                                                                                                                                                                    | 0/26 [00:00<?, ?it/s, loss=0.0487]

Epoch [14/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 261.69it/s, loss=0.0193]
Epoch [15/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 293.47it/s, loss=0.0519]
Epoch 15/100, Loss: 0.052275088257514514
Epoch [16/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 271.63it/s, loss=0.0803]
Epoch 16/100, Loss: 0.04993918308844933
Epoch [17/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 269.18it/s, loss=0.13]
Epoch 17/100, Loss: 0.0493868668205463
Epoch [18/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 292.40it/s, loss=0.0496]
Epoch 18/100, Loss: 0.045515347487078264
Epoch [19/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 282.69it/s, loss=0.0461]
Epoch 19/100, Loss: 0.04378146076431641
Epoch [20/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 285.58it/s, loss=0.0441]
Epoch 20/100, Loss: 0.041810671225763284
Epoch [21/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 282.01it/s, loss=0.0233]
Epoch 21/100, Loss: 0.03914788136115441
Epoch [22/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 304.07it/s, loss=0.0767]
Epoch 22/100, Loss: 0.03889782927357233
Epoch [23/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 266.97it/s, loss=0.0298]
Epoch 23/100, Loss: 0.03669901707997689
Epoch [24/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 254.74it/s, loss=0.0405]
Epoch 24/100, Loss: 0.03541788559120435
Epoch [25/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 288.63it/s, loss=0.0492]
Epoch 25/100, Loss: 0.03522074430321272
Epoch [26/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 292.33it/s, loss=0.034]
Epoch 26/100, Loss: 0.03306383933298863
Epoch [27/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 299.72it/s, loss=0.0391]
Epoch 27/100, Loss: 0.03315563922604689
Epoch [28/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 274.59it/s, loss=0.0346]
Epoch 28/100, Loss: 0.03210709946086773
Epoch [29/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 248.58it/s, loss=0.0215]
Epoch 29/100, Loss: 0.03014442424934644
Epoch [30/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 269.66it/s, loss=0.0194]
Epoch 30/100, Loss: 0.02981328025746804
Epoch [31/100]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 267.20it/s, loss=0.069]
Epoch 31/100, Loss: 0.030921379390817422
Epoch [32/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 263.76it/s, loss=0.0259]
Epoch 32/100, Loss: 0.02923213210530006
Epoch [33/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 265.27it/s, loss=0.0152]
Epoch 33/100, Loss: 0.028846862009511545
Epoch [34/100]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 312.63it/s, loss=0.05]
Epoch 34/100, Loss: 0.028947077190073636
Epoch [35/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 270.77it/s, loss=0.0218]
Epoch 35/100, Loss: 0.027099057817115232
Epoch [36/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 268.76it/s, loss=0.0561]
Epoch 36/100, Loss: 0.02753347487976918
Epoch [37/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 254.50it/s, loss=0.0532]
Epoch 37/100, Loss: 0.029993227754647914
Epoch 38/100, Loss: 0.02857393828722147
Epoch [38/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 298.18it/s, loss=0.0653]
Epoch [39/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 247.00it/s, loss=0.0455]
Epoch 39/100, Loss: 0.029066549972272836
Epoch [40/100]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [00:00<00:00, 267.88it/s, loss=0.0386]
Traceback (most recent call last):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 1087, in convert
    im = self.im.convert(mode, dither)
ValueError: conversion not supported
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/mnt/hdd/pengy/insole_anno/train.py", line 82, in <module>
    train(model, train_loader, test_loader, criterion, optimizer, num_epochs=num_epochs, device="cuda:0" if torch.cuda.is_available() else "cpu")
  File "/mnt/hdd/pengy/insole_anno/train.py", line 38, in train
    test(model, test_loader, criterion, device)
  File "/mnt/hdd/pengy/insole_anno/train.py", line 52, in test
    plot_insole_heatmap_gif(y, outputs, f'./results/test_{i}.gif')
  File "/mnt/hdd/pengy/insole_anno/tools.py", line 87, in plot_insole_heatmap_gif
    frames[0].save(output_path, save_all=True, append_images=frames[1:], loop=0, duration=100)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 2459, in save
    save_handler(self, fp, filename)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 714, in _save_all
    _save(im, fp, filename, save_all=True)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 725, in _save
    if not save_all or not _write_multiple_frames(im, fp, palette):
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 655, in _write_multiple_frames
    mask = ImageMath.lambda_eval(
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 267, in lambda_eval
    out = expression(args)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/GifImagePlugin.py", line 656, in <lambda>
    lambda args: args["convert"](
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/ImageMath.py", line 225, in imagemath_convert
    return _Operand(self.im.convert(mode))
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/PIL/Image.py", line 1095, in convert
    im = im.convert(mode, dither)
KeyboardInterrupt
Epoch 40/100, Loss: 0.026285893068863794